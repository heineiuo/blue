!function(a){function b(a,b){for(var c=0;c<a.length;c++)a[c]==b&&(a.splice(c,1),c--);return a}function c(a){var b=require("crypto").createHash("md5");return b.update(a),b.digest("hex")}function d(a){var b=require("crypto").createHash("sha1");return b.update(a),b.digest("hex")}function e(a,b,c){var a=querystring.stringify(a),b=b;b.method="POST";var d=!1,e=http.request(b,function(a){a.setEncoding("utf8"),a.on("data",function(a){a=JSON.parse(a),c(d,a)})});e.on("error",function(a){console.log("problem with request: "+a.message),d=!0,c(d)}),e.write(a),e.end()}function f(a){var b=require("url"),c=require("formidable"),d=require("querystring"),e=a.method.toLowerCase(),f=b.parse(a.url).pathname,g=f.substr(1).split("/"),h=b.parse(a.url).search,i=null!=h?d.parse(h.substring(1)):{},j=a.headers["x-forwarded-for"]||a.connection.remoteAddress||a.socket.remoteAddress||a.connection.socket.remoteAddress,k={};return a.headers.cookie&&a.headers.cookie.split(";").forEach(function(a){var b=a.split("=");k[b[0].trim()]=(b[1]||"").trim()}),a.method=e,a.pathname=f,a.pathname_arr=g,a.search=h,a.searches=i,a.ip=j,a.cookies=k,a.parse=function(b){if("post"==e){var d=new c.IncomingForm,f={file_stack:[]};d.uploadDir=__dirname,d.on("progress",function(){}).on("field",function(b,c){a.searches[b]=c}).on("file",function(a,b){f.file_stack.push(a,b)}).on("aborted",function(){b("aborted")}).on("error",function(){b("error")}).on("end",function(){b(!1,f)}),d.parse(this)}else b("method_error")},a}function g(a){return a.http_status_code=200,a.contentType="json",a.send=function(b){{var b=b||{},c=this.contentType;this.http_status_code}"json"==c&&"object"==typeof b?(b=JSON.stringify(b),typed="application/json"):(b=String(b),typed="text/plain"),a.writeHead(200,{"Content-Type":[typed,";charset=UTF-8"].join(""),"Access-Control-Allow-Origin":"*"}),a.write(b),a.end()},a.sendError=function(a){this.send({error:a})},a}function h(){function a(){var a={};return a}return a}function i(){function a(a){var c=[],a={apis_errors:{},uri_prefix:a.uri_prefix||"",error:a.error||{},cache_dir:a.cache_dir||__dirname+"/../blue_cache",temp_dir:a.temp_dir||__dirname+"/../blue_cache/temp"},d={listen:function(b){var d=h.createServer(function(b,d){function e(b){for(var d=!1,e=0;e<c.length;e++)if(c[e].uri.test(b.substr(a.uri_prefix.length))){d=c[e];break}return d}function h(){}var b=f(b),d=g(d);if("/"+b.pathname_arr[0]!=a.uri_prefix)d.sendError("NOT_FOUND");else{var i=e(b.pathname);i&&i.method==b.method?i.callback(b,d,h):d.sendError("NOT_FOUND")}});d.listen(b),console.log("SUCCESS: 启动成功, 端口: "+b)},use:function(a,d,e){function f(a){return new RegExp("^\\/"+a.join("\\/")+"$")}function g(){c.push({method:a,uri:d,callback:e})}if("string"==typeof d){var h=b(d.split("/"),"");d=f(h),g()}else if(d instanceof Array)d=f(d),g();else{if(!(d instanceof RegExp))return!1;g()}},get_config:function(){return a}};return d}{var h=require("http");require("url"),require("mysql"),require("util"),require("fs")}return{createServer:a,md5:c,sha1:d,http_post:e}}"function"==typeof define&&define.amd?define([""],h):"object"==typeof exports?module.exports=i():a.blue=h()}(this);